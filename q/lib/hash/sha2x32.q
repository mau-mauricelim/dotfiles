/#######################################
/# SHA-2 (32-bit): SHA-224 and SHA-256 #
/#######################################

/ SHA Properties
.sha2x32.messageSize:64;
.sha2x32.blockSize:512;
.sha2x32.wordSize:32;

/ 4.1.2 SHA-224 and SHA-256 Functions
.sha2x32.Sigma0:.sha.SigmaN -2 -13 -22;
.sha2x32.Sigma1:.sha.SigmaN -6 -11 -25;
.sha2x32.sigma0:.sha.sigmaN -7 -18 3;
.sha2x32.sigma1:.sha.sigmaN -17 -19 10;

/ 4.2.2 SHA-224 and SHA-256 Constants
/ Constants (first 32 bits of the fractional parts of the cube roots of the first 64 prime numbers)
/ @example - flip .codec.decToBin32(2 xexp 32)*mod[;1]{x xexp 1%3}.maths.primes 311
.sha2x32.K:(
    01000010100010100010111110011000b;01110001001101110100010010010001b;10110101110000001111101111001111b;11101001101101011101101110100101b;
    00111001010101101100001001011011b;01011001111100010001000111110001b;10010010001111111000001010100100b;10101011000111000101111011010101b;
    11011000000001111010101010011000b;00010010100000110101101100000001b;00100100001100011000010110111110b;01010101000011000111110111000011b;
    01110010101111100101110101110100b;10000000110111101011000111111110b;10011011110111000000011010100111b;11000001100110111111000101110100b;
    11100100100110110110100111000001b;11101111101111100100011110000110b;00001111110000011001110111000110b;00100100000011001010000111001100b;
    00101101111010010010110001101111b;01001010011101001000010010101010b;01011100101100001010100111011100b;01110110111110011000100011011010b;
    10011000001111100101000101010010b;10101000001100011100011001101101b;10110000000000110010011111001000b;10111111010110010111111111000111b;
    11000110111000000000101111110011b;11010101101001111001000101000111b;00000110110010100110001101010001b;00010100001010010010100101100111b;
    00100111101101110000101010000101b;00101110000110110010000100111000b;01001101001011000110110111111100b;01010011001110000000110100010011b;
    01100101000010100111001101010100b;01110110011010100000101010111011b;10000001110000101100100100101110b;10010010011100100010110010000101b;
    10100010101111111110100010100001b;10101000000110100110011001001011b;11000010010010111000101101110000b;11000111011011000101000110100011b;
    11010001100100101110100000011001b;11010110100110010000011000100100b;11110100000011100011010110000101b;00010000011010101010000001110000b;
    00011001101001001100000100010110b;00011110001101110110110000001000b;00100111010010000111011101001100b;00110100101100001011110010110101b;
    00111001000111000000110010110011b;01001110110110001010101001001010b;01011011100111001100101001001111b;01101000001011100110111111110011b;
    01110100100011111000001011101110b;01111000101001010110001101101111b;10000100110010000111100000010100b;10001100110001110000001000001000b;
    10010000101111101111111111111010b;10100100010100000110110011101011b;10111110111110011010001111110111b;11000110011100010111100011110010b);

/ Initial Hash Value
/ 5.3.2 SHA-224
/ @example - (raze .codec.byteToBin@)@'(0xc1059ed8;0x367cd507;0x3070dd17;0xf70e5939;0xffc00b31;0x68581511;0x64f98fa7;0xbefa4fa4)
.sha2x32.sha224.H:(
    11000001000001011001111011011000b;00110110011111001101010100000111b;00110000011100001101110100010111b;11110111000011100101100100111001b;
    11111111110000000000101100110001b;01101000010110000001010100010001b;01100100111110011000111110100111b;10111110111110100100111110100100b);
.sha2x32.sha224.bit:224;
/ 5.3.3 SHA-256
/ First 32 bits of the fractional parts of the square roots of first 8 prime numbers
/ @example - flip .codec.decToBin32(2 xexp 32)*mod[;1]sqrt .maths.primes 19
.sha2x32.sha256.H:(
    01101010000010011110011001100111b;10111011011001111010111010000101b;00111100011011101111001101110010b;10100101010011111111010100111010b;
    01010001000011100101001001111111b;10011011000001010110100010001100b;00011111100000111101100110101011b;01011011111000001100110100011001b);
.sha2x32.sha256.bit:256;

.Q.sha256:.sha2.hash[`.sha2x32;`sha256];
.Q.sha224:.sha2.hash[`.sha2x32;`sha224];

/#################################################################
/# SHA-2 (64-bit): SHA-384, SHA-512, SHA-512/224 and SHA-512/256 #
/#################################################################

/ SHA Properties
.sha2x64.messageSize:128;
.sha2x64.blockSize:1024;
.sha2x64.wordSize:64;

/ 4.1.3 SHA-384, SHA-512, SHA-512/224 and SHA-512/256 Functions
.sha2x64.Sigma0:.sha.SigmaN -28 -34 -39;
.sha2x64.Sigma1:.sha.SigmaN -14 -18 -41;
.sha2x64.sigma0:.sha.sigmaN -1 -8 7;
.sha2x64.sigma1:.sha.sigmaN -19 -61 6;

/ 4.2.3 SHA-384, SHA-512, SHA-512/224 and SHA-512/256 Constants
/ Constants (first 64 bits of the fractional parts of the cube roots of the first 80 prime numbers)
/ @example - (raze .codec.byteToBin@)@'(0x428a2f98d728ae22;0x7137449123ef65cd;0xb5c0fbcfec4d3b2f;0xe9b5dba58189dbbc;...)
.sha2x64.K:(
    0100001010001010001011111001100011010111001010001010111000100010b;0111000100110111010001001001000100100011111011110110010111001101b;1011010111000000111110111100111111101100010011010011101100101111b;1110100110110101110110111010010110000001100010011101101110111100b;
    0011100101010110110000100101101111110011010010001011010100111000b;0101100111110001000100011111000110110110000001011101000000011001b;1001001000111111100000101010010010101111000110010100111110011011b;1010101100011100010111101101010111011010011011011000000100011000b;
    1101100000000111101010101001100010100011000000110000001001000010b;0001001010000011010110110000000101000101011100000110111110111110b;0010010000110001100001011011111001001110111001001011001010001100b;0101010100001100011111011100001111010101111111111011010011100010b;
    0111001010111110010111010111010011110010011110111000100101101111b;1000000011011110101100011111111000111011000101101001011010110001b;1001101111011100000001101010011100100101110001110001001000110101b;1100000110011011111100010111010011001111011010010010011010010100b;
    1110010010011011011010011100000110011110111100010100101011010010b;1110111110111110010001111000011000111000010011110010010111100011b;0000111111000001100111011100011010001011100011001101010110110101b;0010010000001100101000011100110001110111101011001001110001100101b;
    0010110111101001001011000110111101011001001010110000001001110101b;0100101001110100100001001010101001101110101001101110010010000011b;0101110010110000101010011101110010111101010000011111101111010100b;0111011011111001100010001101101010000011000100010101001110110101b;
    1001100000111110010100010101001011101110011001101101111110101011b;1010100000110001110001100110110100101101101101000011001000010000b;1011000000000011001001111100100010011000111110110010000100111111b;1011111101011001011111111100011110111110111011110000111011100100b;
    1100011011100000000010111111001100111101101010001000111111000010b;1101010110100111100100010100011110010011000010101010011100100101b;0000011011001010011000110101000111100000000000111000001001101111b;0001010000101001001010010110011100001010000011100110111001110000b;
    0010011110110111000010101000010101000110110100100010111111111100b;0010111000011011001000010011100001011100001001101100100100100110b;0100110100101100011011011111110001011010110001000010101011101101b;0101001100111000000011010001001110011101100101011011001111011111b;
    0110010100001010011100110101010010001011101011110110001111011110b;0111011001101010000010101011101100111100011101111011001010101000b;1000000111000010110010010010111001000111111011011010111011100110b;1001001001110010001011001000010100010100100000100011010100111011b;
    1010001010111111111010001010000101001100111100010000001101100100b;1010100000011010011001100100101110111100010000100011000000000001b;1100001001001011100010110111000011010000111110001001011110010001b;1100011101101100010100011010001100000110010101001011111000110000b;
    1101000110010010111010000001100111010110111011110101001000011000b;1101011010011001000001100010010001010101011001011010100100010000b;1111010000001110001101011000010101010111011100010010000000101010b;0001000001101010101000000111000000110010101110111101000110111000b;
    0001100110100100110000010001011010111000110100101101000011001000b;0001111000110111011011000000100001010001010000011010101101010011b;0010011101001000011101110100110011011111100011101110101110011001b;0011010010110000101111001011010111100001100110110100100010101000b;
    0011100100011100000011001011001111000101110010010101101001100011b;0100111011011000101010100100101011100011010000011000101011001011b;0101101110011100110010100100111101110111011000111110001101110011b;0110100000101110011011111111001111010110101100101011100010100011b;
    0111010010001111100000101110111001011101111011111011001011111100b;0111100010100101011000110110111101000011000101110010111101100000b;1000010011001000011110000001010010100001111100001010101101110010b;1000110011000111000000100000100000011010011001000011100111101100b;
    1001000010111110111111111111101000100011011000110001111000101000b;1010010001010000011011001110101111011110100000101011110111101001b;1011111011111001101000111111011110110010110001100111100100010101b;1100011001110001011110001111001011100011011100100101001100101011b;
    1100101000100111001111101100111011101010001001100110000110011100b;1101000110000110101110001100011100100001110000001100001000000111b;1110101011011010011111011101011011001101111000001110101100011110b;1111010101111101010011110111111111101110011011101101000101111000b;
    0000011011110000011001111010101001110010000101110110111110111010b;0000101001100011011111011100010110100010110010001001100010100110b;0001000100111111100110000000010010111110111110010000110110101110b;0001101101110001000010110011010100010011000111000100011100011011b;
    0010100011011011011101111111010100100011000001000111110110000100b;0011001011001010101010110111101101000000110001110010010010010011b;0011110010011110101111100000101000010101110010011011111010111100b;0100001100011101011001111100010010011100000100000000110101001100b;
    0100110011000101110101001011111011001011001111100100001010110110b;0101100101111111001010011001110011111100011001010111111000101010b;0101111111001011011011111010101100111010110101101111101011101100b;0110110001000100000110011000110001001010010001110101100000010111b);

/ Initial Hash Value
/ 5.3.4 SHA-384
/ First 64 bits of the fractional parts of the square roots of the second 8 prime numbers
/ @example - (raze .codec.byteToBin@)@'(0xcbbb9d5dc1059ed8;0x629a292a367cd507;0x9159015a3070dd17;0x152fecd8f70e5939;0x67332667ffc00b31;0x8eb44a8768581511;0xdb0c2e0d64f98fa7;0x47b5481dbefa4fa4)
.sha2x64.sha384.H:(
    1100101110111011100111010101110111000001000001011001111011011000b;0110001010011010001010010010101000110110011111001101010100000111b;1001000101011001000000010101101000110000011100001101110100010111b;0001010100101111111011001101100011110111000011100101100100111001b;
    0110011100110011001001100110011111111111110000000000101100110001b;1000111010110100010010101000011101101000010110000001010100010001b;1101101100001100001011100000110101100100111110011000111110100111b;0100011110110101010010000001110110111110111110100100111110100100b);
.sha2x64.sha384.bit:384;
/ 5.3.5 SHA-512
/ First 64 bits of the fractional parts of the square roots of first 8 prime numbers
/ @example - (raze .codec.byteToBin@)@'(0x6a09e667f3bcc908;0xbb67ae8584caa73b;0x3c6ef372fe94f82b;0xa54ff53a5f1d36f1;0x510e527fade682d1;0x9b05688c2b3e6c1f;0x1f83d9abfb41bd6b;0x5be0cd19137e2179)
.sha2x64.sha512.H:(
    0110101000001001111001100110011111110011101111001100100100001000b;1011101101100111101011101000010110000100110010101010011100111011b;0011110001101110111100110111001011111110100101001111100000101011b;1010010101001111111101010011101001011111000111010011011011110001b;
    0101000100001110010100100111111110101101111001101000001011010001b;1001101100000101011010001000110000101011001111100110110000011111b;0001111110000011110110011010101111111011010000011011110101101011b;0101101111100000110011010001100100010011011111100010000101111001b);
.sha2x64.sha512.bit:512;

/ 5.3.6.1 SHA-512/224
/ @example - (raze .codec.byteToBin@)@'(0x8c3d37c819544da2;0x73e1996689dcd4d6;0x1dfab7ae32ff9c82;0x679dd514582f9fcf;0x0f6d2b697bd44da8;0x77e36f7304c48942;0x3f9d85a86a1d36c8;0x1112e6ad91d692a1)
.sha2x64.sha512x224.H:(
    1000110000111101001101111100100000011001010101000100110110100010b;0111001111100001100110010110011010001001110111001101010011010110b;0001110111111010101101111010111000110010111111111001110010000010b;0110011110011101110101010001010001011000001011111001111111001111b;
    0000111101101101001010110110100101111011110101000100110110101000b;0111011111100011011011110111001100000100110001001000100101000010b;0011111110011101100001011010100001101010000111010011011011001000b;0001000100010010111001101010110110010001110101101001001010100001b);
.sha2x64.sha512x224.bit:224;
/ 5.3.6.2 SHA-512/256
/ @example - (raze .codec.byteToBin@)@'(0x22312194fc2bf72c;0x9f555fa3c84c64c2;0x2393b86b6f53b151;0x963877195940eabd;0x96283ee2a88effe3;0xbe5e1e2553863992;0x2b0199fc2c85b8aa;0x0eb72ddc81c52ca2)
.sha2x64.sha512x256.H:(
    0010001000110001001000011001010011111100001010111111011100101100b;1001111101010101010111111010001111001000010011000110010011000010b;0010001110010011101110000110101101101111010100111011000101010001b;1001011000111000011101110001100101011001010000001110101010111101b;
    1001011000101000001111101110001010101000100011101111111111100011b;1011111001011110000111100010010101010011100001100011100110010010b;0010101100000001100110011111110000101100100001011011100010101010b;0000111010110111001011011101110010000001110001010010110010100010b);
.sha2x64.sha512x256.bit:256;

.Q.sha384:.sha2.hash[`.sha2x64;`sha384];
.Q.sha512:.sha2.hash[`.sha2x64;`sha512];

.Q.sha512x224:.sha2.hash[`.sha2x64;`sha512x224];
.Q.sha512x256:.sha2.hash[`.sha2x64;`sha512x256];
